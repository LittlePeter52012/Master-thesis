%==========================================================================
function SIRS_NL_Tan % 15.04.2022
%--------------------------------------------------------------------------
global k1 k2 k3; 
%--------------------------------------------------------------------------
format longe
%--------------------------------------------------------------------------
k1 = 1.0;    % SIRS
k2 = 1.0;    % SIRS
k3 = 0.005;  % SIRS

time_max = 300; 
thetaI0 = 0.0001;
thetaR0 = 0.0000;

%--------------------------------------------------------------------------
options1 = odeset('RelTol', 1e-12, 'AbsTol', 1e-12); %, 'Refine', 10); %'Events', @RAFT_events_1); 
tspan = [0.0 time_max];
f0 = [thetaI0; thetaR0];
[t, f] = ode15s(@SIRS, tspan, f0, options1);
%--------------------------------------------------------------------------
plot( t, f(:,1), 'LineWidth', 2, 'Color', 'r' ); hold on;
plot( t, f(:,2), 'LineWidth', 2, 'Color', 'b' ); hold on;
plot( t, 1 - f(:,1) - f(:,2), 'LineWidth', 2, 'Color', 'black' ); hold on;
legend ('\theta_I', '\theta_R', '\theta_S' )
%--------------------------------------------------------------------------
xlim([0 time_max]);
ylim([0 1]);
xlabel('time', 'FontSize', 14); ylabel('\theta', 'FontSize', 14); hold on;
title('SIRS', 'FontSize', 14); hold on; grid on; 
hold on;
%--------------------------------------------------------------------------
%close all;

%==========================================================================
function dfdt = SIRS(t, f) % SIRS
%--------------------------------------------------------------------------
global k1 k2 k3; 
%--------------------------------------------------------------------------
% f: 1-theta_I;   2-theta_R 
%--------------------------------------------------------------------------

dfdt = [   k1*4*f(1,:)*(1 - f(1,:) - f(2,:)) - k2*f(1,:)
           k2*f(1,:) - k3*f(2,:)];

%==========================================================================
