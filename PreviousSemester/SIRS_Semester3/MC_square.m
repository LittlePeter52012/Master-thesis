%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
function MC_square
%==========================================================================
% Модель SIR на квадратной решётке, кинетический метод МК
%**************************************************************************
global k1 k2 k3 d1 d2
global class_MC
%**************************************************************************
% Значения скоростей
k1 = 1.0;
k2 = 2.0; 
k3 = 3.0;
d1 = 4.0;
d2 = 5.0;
%--------------------------------------------------------------------------
% Описание классов для квадратной решётки при трёх состояниях узлов
class_MC_def;

%--------------------------------------------------------------------------
% Начальное состояние поверхности
% ini_MC_def;

%@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
function class_MC_def
%==========================================================================
% Описание классов для квадратной решётки при трёх состояниях узлов
%**************************************************************************
global class_MC
global k1 k2 k3 d1 d2
%**************************************************************************
% class_MC(1,66) = struct('number', 0.0, ...
%                         'rates', [0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0], ...
%                         'sum_rates', 0.0, ...
%                         'numb_rates', 0.0);
%**************************************************************************
class_MC(1).number     = 00001;
class_MC(1).rates      = [k2 ...
                          k2+k1 k2+2*k1 k2+3*k1 k2+4*k1 ...
                          k2+4*k1+d1 k2+4*k1+2*d1 k2+4*k1+3*d1 k2+4*k1+4*d1]
class_MC(1).numb_rates = 9;
class_MC(1).sum_rates  = class_MC(1).rates(class_MC(1).numb_rates);
class_MC(1).rates      = class_MC(1).rates/class_MC(1).sum_rates;
% a = class_MC(1).rates
%**************************************************************************
class_MC(2).number     = 00201;
class_MC(2).rates      = [k2 ...
                          k2+k1 k2+2*k1 k2+3*k1 ...
                          k2+3*k1+d1 k2+3*k1+2*d1 k2+3*k1+3*d1 ...
                          k2+3*k1+3*d1+d2];
class_MC(2).numb_rates = 8;
class_MC(2).sum_rates  = class_MC(2).rates(class_MC(2).numb_rates);
class_MC(2).rates      = class_MC(2).rates/class_MC(2).sum_rates;
% a = class_MC(2).rates
%--------------------------------------------------------------------------
class_MC(3)            = class_MC(2);
class_MC(3).number     = 00021;
%--------------------------------------------------------------------------
class_MC(4)            = class_MC(2);
class_MC(4).number     = 20001;
%--------------------------------------------------------------------------
class_MC(5)            = class_MC(2);
class_MC(5).number     = 02001;
%**************************************************************************
class_MC(6).number     = 00101;
class_MC(6).rates      = [k2 ...
                          k2+k1 k2+2*k1 k2+3*k1 ...
                          k2+3*k1+d1 k2+3*k1+2*d1 k2+3*k1+3*d1];
class_MC(6).numb_rates = 7;
class_MC(6).sum_rates  = class_MC(6).rates(class_MC(6).numb_rates);
class_MC(6).rates      = class_MC(6).rates/class_MC(6).sum_rates;
% a = class_MC(6).rates
%--------------------------------------------------------------------------
class_MC(7)            = class_MC(6);
class_MC(7).number     = 00011;
%--------------------------------------------------------------------------
class_MC(8)            = class_MC(6);
class_MC(8).number     = 10001;
%--------------------------------------------------------------------------
class_MC(9)            = class_MC(6);
class_MC(9).number     = 01001;
%**************************************************************************
class_MC(10).number     = 00221;
class_MC(10).rates      = [k2 ...
                           k2+k1 k2+2*k1 ...
                           k2+2*k1+d1 k2+2*k1+2*d1 ...
                           k2+2*k1+2*d1+d2 k2+2*k1+2*d1+2*d2];
class_MC(10).numb_rates = 7;
class_MC(10).sum_rates  = class_MC(10).rates(class_MC(10).numb_rates);
%--------------------------------------------------------------------------
class_MC(11)            = class_MC(10);
class_MC(11).number     = 20021;
%--------------------------------------------------------------------------
class_MC(12)            = class_MC(10);
class_MC(12).number     = 22001;
%--------------------------------------------------------------------------
class_MC(13)            = class_MC(10);
class_MC(13).number     = 02201;
%--------------------------------------------------------------------------
class_MC(14)            = class_MC(10);
class_MC(14).number     = 20201;
%--------------------------------------------------------------------------
class_MC(15)            = class_MC(10);
class_MC(15).number     = 02021;
%**************************************************************************
class_MC(16).number     = 00111;
class_MC(16).rates      = [k2 ...
                           k2+k1 k2+2*k1 ...
                           k2+2*k1+d1 k2+2*k1+2*d1];
class_MC(16).numb_rates = 5;
class_MC(16).sum_rates  = class_MC(16).rates(class_MC(16).numb_rates);
class_MC(16).rates      = class_MC(16).rates/class_MC(16).sum_rates;
% a = class_MC(16).rates
%--------------------------------------------------------------------------
class_MC(17)            = class_MC(16);
class_MC(17).number     = 10011;
%--------------------------------------------------------------------------
class_MC(18)            = class_MC(16);
class_MC(18).number     = 11001;
%--------------------------------------------------------------------------
class_MC(19)            = class_MC(16);
class_MC(19).number     = 01101;
%--------------------------------------------------------------------------
class_MC(20)            = class_MC(16);
class_MC(20).number     = 10101;
%--------------------------------------------------------------------------
class_MC(21)            = class_MC(16);
class_MC(21).number     = 01011;
%**************************************************************************
class_MC(22).number     = 00121;
class_MC(22).rates      = [k2 ...
                           k2+k1 k2+2*k1 ...
                           k2+2*k1+d1 k2+2*k1+2*d1 ...
                           k2+2*k1+2*d1+d2];
class_MC(22).numb_rates = 6;
class_MC(22).sum_rates  = class_MC(22).rates(class_MC(22).numb_rates);
class_MC(22).rates      = class_MC(22).rates/class_MC(22).sum_rates;
% a = class_MC(22).rates
%--------------------------------------------------------------------------
class_MC(23)            = class_MC(22);
class_MC(23).number     = 20011;
%--------------------------------------------------------------------------
class_MC(24)            = class_MC(22);
class_MC(24).number     = 12001;
%--------------------------------------------------------------------------
class_MC(25)            = class_MC(22);
class_MC(25).number     = 01201;
%--------------------------------------------------------------------------
class_MC(26)            = class_MC(22);
class_MC(26).number     = 20101;
%--------------------------------------------------------------------------
class_MC(27)            = class_MC(22);
class_MC(27).number     = 02011;
%--------------------------------------------------------------------------
class_MC(28)            = class_MC(22);
class_MC(28).number     = 00211;
%--------------------------------------------------------------------------
class_MC(29)            = class_MC(22);
class_MC(29).number     = 10021;
%--------------------------------------------------------------------------
class_MC(30)            = class_MC(22);
class_MC(30).number     = 21001;
%--------------------------------------------------------------------------
class_MC(31)            = class_MC(22);
class_MC(31).number     = 02101;
%--------------------------------------------------------------------------
class_MC(32)            = class_MC(22);
class_MC(32).number     = 10201;
%--------------------------------------------------------------------------
class_MC(33)            = class_MC(22);
class_MC(33).number     = 01021;
%**************************************************************************
class_MC(34).number     = 20221;
class_MC(34).rates      = [k2 ...
                           k2+k1 ...
                           k2+k1+d1 ...
                           k2+k1+d1+d2 k2+k1+d1+2*d2 k2+k1+d1+3*d2];
class_MC(34).numb_rates = 6;
class_MC(34).sum_rates  = class_MC(34).rates(class_MC(34).numb_rates);
class_MC(34).rates      = class_MC(34).rates/class_MC(34).sum_rates;
% a = class_MC(34).rates
%--------------------------------------------------------------------------
class_MC(35)            = class_MC(34);
class_MC(35).number     = 22021;
%--------------------------------------------------------------------------
class_MC(36)            = class_MC(34);
class_MC(36).number     = 22201;
%--------------------------------------------------------------------------
class_MC(37)            = class_MC(34);
class_MC(37).number     = 02221;
%**************************************************************************
class_MC(38).number     = 10111;
class_MC(38).rates      = [k2 ...
                           k2+k1 ...
                           k2+k1+d1];
class_MC(38).numb_rates = 3;
class_MC(38).sum_rates  = class_MC(38).rates(class_MC(38).numb_rates);
class_MC(38).rates      = class_MC(38).rates/class_MC(38).sum_rates;
% a = class_MC(38).rates
%--------------------------------------------------------------------------
class_MC(39)            = class_MC(38);
class_MC(39).number     = 11011;
%--------------------------------------------------------------------------
class_MC(40)            = class_MC(38);
class_MC(40).number     = 11101;
%--------------------------------------------------------------------------
class_MC(41)            = class_MC(38);
class_MC(41).number     = 01111;
%**************************************************************************
class_MC(42).number     = 20121;
class_MC(42).rates      = [k2 ...
                           k2+k1 ...
                           k2+k1+d1 ...
                           k2+k1+d1+d2 k2+k1+d1+2*d2];
class_MC(42).numb_rates = 5;
class_MC(42).sum_rates  = class_MC(42).rates(class_MC(42).numb_rates);
class_MC(42).rates      = class_MC(42).rates/class_MC(42).sum_rates;
% a = class_MC(42).rates
%--------------------------------------------------------------------------
class_MC(43)            = class_MC(42);
class_MC(43).number     = 22011;
%--------------------------------------------------------------------------
class_MC(44)            = class_MC(42);
class_MC(44).number     = 12201;
%--------------------------------------------------------------------------
class_MC(45)            = class_MC(42);
class_MC(45).number     = 02211;
%--------------------------------------------------------------------------
class_MC(46)            = class_MC(42);
class_MC(46).number     = 20211;
%--------------------------------------------------------------------------
class_MC(47)            = class_MC(42);
class_MC(47).number     = 12021;
%--------------------------------------------------------------------------
class_MC(48)            = class_MC(42);
class_MC(48).number     = 21201;
%--------------------------------------------------------------------------
class_MC(49)            = class_MC(42);
class_MC(49).number     = 02121;
%--------------------------------------------------------------------------
class_MC(50)            = class_MC(42);
class_MC(50).number     = 10221;
%--------------------------------------------------------------------------
class_MC(51)            = class_MC(42);
class_MC(51).number     = 21021;
%--------------------------------------------------------------------------
class_MC(52)            = class_MC(42);
class_MC(52).number     = 22101;
%--------------------------------------------------------------------------
class_MC(53)            = class_MC(42);
class_MC(53).number     = 01221;
%**************************************************************************
class_MC(54).number     = 20111;
class_MC(54).rates      = [k2 ...
                           k2+k1 ...
                           k2+k1+d1 ...
                           k2+k1+d1+d2];
class_MC(54).numb_rates = 4;
class_MC(54).sum_rates  = class_MC(54).rates(class_MC(54).numb_rates);
class_MC(54).rates      = class_MC(54).rates/class_MC(54).sum_rates;
% a = class_MC(54).rates
%--------------------------------------------------------------------------
class_MC(55)            = class_MC(54);
class_MC(55).number     = 12011;
%--------------------------------------------------------------------------
class_MC(56)            = class_MC(54);
class_MC(56).number     = 11201;
%--------------------------------------------------------------------------
class_MC(57)            = class_MC(54);
class_MC(57).number     = 02111;
%--------------------------------------------------------------------------
class_MC(58)            = class_MC(54);
class_MC(58).number     = 10211;
%--------------------------------------------------------------------------
class_MC(59)            = class_MC(54);
class_MC(59).number     = 11021;
%--------------------------------------------------------------------------
class_MC(60)            = class_MC(54);
class_MC(60).number     = 21101;
%--------------------------------------------------------------------------
class_MC(61)            = class_MC(54);
class_MC(61).number     = 01121;
%--------------------------------------------------------------------------
class_MC(62)            = class_MC(54);
class_MC(62).number     = 10121;
%--------------------------------------------------------------------------
class_MC(63)            = class_MC(54);
class_MC(63).number     = 21011;
%--------------------------------------------------------------------------
class_MC(64)            = class_MC(54);
class_MC(64).number     = 12101;
%--------------------------------------------------------------------------
class_MC(65)            = class_MC(54);
class_MC(65).number     = 01211;
%**************************************************************************
class_MC(66).number     = 11111;
class_MC(66).rates      = [k2];
class_MC(66).numb_rates = 1;
class_MC(66).sum_rates  = class_MC(66).rates(class_MC(66).numb_rates);
class_MC(66).rates      = class_MC(66).rates/class_MC(66).sum_rates;
% a = class_MC(66).rates
%**************************************************************************
class_MC(67).number     = 22221;
class_MC(67).rates      = [k2 ...
                           k2+d2 ...
                           k2+2*d2 ...
                           k2+3*d2 ...
                           k2+4*d2];
class_MC(67).numb_rates = 5;
class_MC(67).sum_rates  = class_MC(67).rates(class_MC(67).numb_rates);
class_MC(67).rates      = class_MC(67).rates/class_MC(67).sum_rates;
% a = class_MC(67).rates
%**************************************************************************
class_MC(68).number     = 21111;
class_MC(68).rates      = [k2 ...
                           k2+d2];
class_MC(68).numb_rates = 2;
class_MC(68).sum_rates  = class_MC(68).rates(class_MC(68).numb_rates);
class_MC(68).rates      = class_MC(68).rates/class_MC(68).sum_rates;
% a = class_MC(68).rates
%--------------------------------------------------------------------------
class_MC(69)            = class_MC(68);
class_MC(69).number     = 12111;
%--------------------------------------------------------------------------
class_MC(70)            = class_MC(68);
class_MC(70).number     = 11211;
%--------------------------------------------------------------------------
class_MC(71)            = class_MC(68);
class_MC(71).number     = 11121;
%**************************************************************************
class_MC(72).number     = 21121;
class_MC(72).rates      = [k2 ...
                           k2+d2 ...
                           k2+2*d2];
class_MC(72).numb_rates = 3;
class_MC(72).sum_rates  = class_MC(72).rates(class_MC(72).numb_rates);
class_MC(72).rates      = class_MC(72).rates/class_MC(72).sum_rates;
% a = class_MC(72).rates
%--------------------------------------------------------------------------
class_MC(73)            = class_MC(72);
class_MC(73).number     = 22111;
%--------------------------------------------------------------------------
class_MC(74)            = class_MC(72);
class_MC(74).number     = 12211;
%--------------------------------------------------------------------------
class_MC(75)            = class_MC(72);
class_MC(75).number     = 11221;
%--------------------------------------------------------------------------
class_MC(76)            = class_MC(72);
class_MC(76).number     = 12121;
%--------------------------------------------------------------------------
class_MC(77)            = class_MC(72);
class_MC(77).number     = 21211;
%**************************************************************************
class_MC(78).number     = 12221;
class_MC(78).rates      = [k2 ...
                           k2+d2 ...
                           k2+2*d2 ...
                           k2+3*d2];
class_MC(78).numb_rates = 4;
class_MC(78).sum_rates  = class_MC(78).rates(class_MC(78).numb_rates);
class_MC(78).rates      = class_MC(78).rates/class_MC(78).sum_rates;
% a = class_MC(78).rates
%--------------------------------------------------------------------------
class_MC(79)            = class_MC(78);
class_MC(79).number     = 21221;
%--------------------------------------------------------------------------
class_MC(80)            = class_MC(78);
class_MC(80).number     = 22121;
%--------------------------------------------------------------------------
class_MC(81)            = class_MC(78);
class_MC(81).number     = 22211;
%**************************************************************************
class_MC(82).number     = 00002;
class_MC(82).rates      = [k3];
class_MC(82).numb_rates = 1;
class_MC(82).sum_rates  = class_MC(82).rates(class_MC(82).numb_rates);
class_MC(82).rates      = class_MC(82).rates/class_MC(82).sum_rates;
a = class_MC(82).rates
%==========================================================================
